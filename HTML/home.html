<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
        <link rel="stylesheet" href="../CSS/styles.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    </head>
    <body>
        <div class="contenido" id="orrialdea"></div>

        <!--xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx BOTONES xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-->

        <div class="home" id="home">
            <div class="containerPage" id="upHorario">
                <div class="input-group">
                    <input type="text" class="form-control buscar" placeholder="Buscar por nombre" v-model="bilatu">
                    <div class="input-group-append">
                        <button class="btn lupa" type="button">
                            <i class="bi bi-search"></i>
                        </button>
                        <button type="button" class="btn añadir btn-lg" @click="popupCita('')">Nueva Cita</button>
                        <button type="button" id="editarRoles" class="btn añadir btn-lg" @click="mostrarRoles">Asignar Roles</button>
                        <button type="button" id="editarHorarios" class="btn añadir btn-lg" @click="mostrarVentana()">Editar Horario</button> 
                    </div>
                </div>

                <div id="fondoOscuro" class="fondo-ocultoHorarios" @click="ocultarVentana(), ocultarRoles()"></div>

                <!--xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx HORARIOS xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-->

                <div class="tablaHorarios" id="tablaHorarios">

                    <div class="contenidoTabla">
                        <div class="input-group-horarios">
                            <button type="button" id="cerrarHorarios" class="btn x" @click="ocultarVentana()">
                                <i class="bi bi-x"></i>
                            </button>
                        </div>
                        <table id="tabla" class="table table-hover table-striped">
                        <thead>
                        <tr>
                            <th scope="col">Día</th>
                            <th scope="col">Grupo</th>
                            <th scope="col">Fecha Inicio</th>
                            <th scope="col">Fecha Fin</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Lunes</td>
                            <td>
                                <select class="form-select combobox" aria-label="Default select example" v-model="dias[0]">
                                    <!-- <option :value="grupo[0].IZENA" selected>{{ grupo[0].IZENA }}</option> -->
                                    <!-- <option selected>a</option> -->
                                    <!-- <option   v-for="(grupos,index) in grupo" :key="index" :value="grupos.IZENA" >{{ grupos.IZENA }}</option> -->
                                    <option   v-for="(dato,index) in datos" :key="index" :value="dato.izena">{{ dato.izena }}</option>
                                </select>
                            </td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[0].HASIERA_DATA"></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[0].AMAIERA_DATA"></td>
                            <td><button type="button" class="btn papelera btn-sm" @click="eliminar(1)"><i class="bi bi-trash"></i></button></td>
                        </tr>
                        <tr>
                            <td>Martes</td>
                            <td><select class="form-select combobox" aria-label="Default select example" v-model="dias[1]">
                                <option   v-for="(dato,index) in datos" :key="index" :value="dato.izena">{{ dato.izena }}</option>
                            </select></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[1].HASIERA_DATA"></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[1].AMAIERA_DATA"></td>
                            <td><button type="button" class="btn papelera btn-sm" @click="eliminar(2)"><i class="bi bi-trash"></i></button></td>
                        </tr>
                        <tr>
                            <td>Miércoles</td>
                            <td><select class="form-select combobox" aria-label="Default select example" v-model="dias[2]">
                                <option   v-for="(dato,index) in datos" :key="index" :value="dato.izena">{{ dato.izena }}</option>
                            </select></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[2].HASIERA_DATA"></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[2].AMAIERA_DATA"></td>
                            <td><button type="button" class="btn papelera btn-sm" @click="eliminar(3)"><i class="bi bi-trash"></i></button></td>
                        </tr>
                        <tr>
                            <td>Jueves</td>
                            <td><select class="form-select combobox" aria-label="Default select example" v-model="dias[3]">
                                <option   v-for="(dato,index) in datos" :key="index" :value="dato.izena">{{ dato.izena }}</option>
                            </select></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[3].HASIERA_DATA"></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[3].AMAIERA_DATA"></td>
                            <td><button type="button" class="btn papelera btn-sm" @click="eliminar(4)"><i class="bi bi-trash"></i></button></td>
                        </tr>
                        <tr>
                            <td>Viernes</td>
                            <td><select class="form-select combobox" aria-label="Default select example" v-model="dias[4]">
                                <option   v-for="(dato,index) in datos" :key="index" :value="dato.izena">{{ dato.izena }}</option>
                            </select></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[4].HASIERA_DATA"></td>
                            <td><input type="date" id="birthday" name="birthday" v-model="fecha[4].AMAIERA_DATA"></td>
                            <td><button type="button" class="btn papelera btn-sm" @click="eliminar(5)"><i class="bi bi-trash"></i></button></td>
                        </tr>
                        </tbody>
                        </table>
                        <div class="input-group-horarios">
                            <button type="button" id="aceptarHorarios" class="btn añadir btn-lg" @click="aceptarCambios()">Aceptar</button>
                            <button type="button" id="cancelarHorarios" class="btn cancelar btn-lg" @click="ocultarVentana()">Cancelar</button>
                        </div>
                    </div>
                </div>

                <!--xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx ROLES xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-->

                <div class="tablaRoles" id="tablaRoles">
                    <div class="contenidoTabla">
                        <div class="row">
                            <div class="col">
                                <h2>Grupo: <span v-text="grupoHoy"></span></h2>
                            </div>
                            
                            <div class="col input-group-horarios">
                                <button type="button" id="cerrarHorarios" class="btn x" @click="ocultarRoles()">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </div>
                        

                        <div class="row align-items-start">
                            <div class="col-md-7">
                                <table id="tabla" class="table table-hover table-striped">
                                    <thead>
                                        <tr>
                                            <th scope="col">Alumno</th>
                                            <th scope="col">Limpieza</th>
                                            <th scope="col">Mostrador</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(data, index) in datosRoles" :key="index" :id="data.id_langilea">
                                            <td>{{data.izena}} {{data.abizenak}}</td>
                                            <td>{{data.suma_g}}</td>
                                            <td>{{data.suma_m}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-md-5">
                                <h2 style="background-color: #E99857;">Asignar Roles</h2>
                                <hr>
                                <div class="row">
                                    <div class="col">
                                        <h3>Mostrador</h3>
                                        <div class="form-floating">
                                            <select class="form-select combobox" id="floatingSelect" aria-label="Floating label select example" v-model="mostrador">
                                            <option v-for="(data, index) in datosRoles" :key="index" :value="data.id_langilea">{{data.izena}} {{data.abizenak}}</option>
                                            </select>
                                            <label for="floatingSelect">Works with selects</label>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <h3>Limpieza</h3>
                                        <div class="form-floating">
                                            <select class="form-select combobox" id="floatingSelect" aria-label="Floating label select example" v-model="limpieza">
                                            <option v-for="(data, index) in datosRoles" :key="index" :value="data.id_langilea">{{data.izena}} {{data.abizenak}}</option>
                                            </select>
                                            <label for="floatingSelect">Works with selects</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="input-group-horarios">
                            <button type="button" id="aceptarHorarios" class="btn añadir btn-lg" @click="aceptarRoles()">Aceptar</button>
                            <button type="button" id="cancelarHorarios" class="btn cancelar btn-lg" @click="ocultarRoles()">Cancelar</button>
                        </div>
                    </div>
                </div>

                <!--xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx CITAS xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-->

                <!-- <div class="tablaCitas" id="tablaCitas">
                    <div class="contenidoTabla">
                        <div class="row mt-3">
                            <div class="col">
                                <h2>Nueva Cita</h2>
                            </div>
                            
                            <div class="col input-group-horarios">
                                <button type="button" id="cerrarHorarios" class="btn x" @click="ocultarRoles()">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </div>
                        <hr>
                        <div class="row align-items-center">
                            <div class="col">
                                <h3><label for="name">Nombre:</label></h3>
                                <input type="text" id="name" name="name" required size="50" />
                            </div>
                            <div class="col">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h3>¿Del centro?</h3>
                                    </div>
                                    <div class="col">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
                                            <label class="form-check-label" for="flexSwitchCheckDefault">Default switch checkbox input</label>
                                        </div>    
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr>

                        <div class="row align-items-center">
                            <div class="col d-flex">
                                <h3 class="me-3">Hora - Inicio</h3>
                                <input type="time" id="appt" name="appt" min="09:00" max="18:00" required />
                            </div>
                            <div class="col d-flex">
                                <h3 class="me-3">Hora - Fin</h3>
                                <input type="time" id="appt" name="appt" min="09:00" max="18:00" required />
                            </div>
                        </div>

                        <hr>

                        <div class="row align-items-center">
                            <div class="col">
                                <h3><label for="name">Teléfono:</label></h3>
                                <input type="tel" id="name" name="name" required size="50" />
                            </div>
                            <div class="col">
                                <h3><label for="name">Alumno:</label></h3>
                                <select class="form-select combobox" aria-label="Default select example">
                                    <option>A</option>
                                </select>
                            </div>
                        </div>

                        <hr>

                        <div class="row align-items-center">
                            <div class="col">
                                <h3><label for="name">Observaciones:</label></h3>
                                <input type="text" id="name" name="name" required size="100" />
                            </div>
                        </div>

                        <div class="input-group-horarios">
                            <button type="button" id="aceptarHorarios" class="btn añadir btn-lg" @click="">Aceptar</button>
                            <button type="button" id="cancelarHorarios" class="btn cancelar btn-lg" @click="">Cancelar</button>
                        </div>
                    </div>
                </div> -->

            </div>

            <div class="container">
                <!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
                <div id="horario2" class="horario2">
                    <!--  -->
                    <div @click="quitarFondoNegro" id="fondoOscuro2" class="fondo-oculto"></div>
                    <div id="ventanaEmergenteLangile" class="ventana-oculta" style="background-color: #F4E3C8; width: 50vw; border-radius: 25px;">
                        <div class="input-group-horarios">
                            <button type="button" id="cerrarVentanaLangile" class="btn x" @click="quitarFondoNegro">
                                <i class="bi bi-x"></i>
                            </button>
                        </div>
                        <form class="row g-3 p-5">
                            <!-- Primera Fila -->
                            <div class="col-md-12">
                                <div class="row g-3">
                                    <div class="col">
                                        <label class="form-label rounded bg-white p-2 mb-1">Nombre: </label>
                                    </div>
                                    <div class="col">
                                        <div class="form-check-reverse form-switch d-flex justify-content-center">
                                            <label class="form-check-label rounded bg-white p-2 mx-2 mb-1 text-center">Del Centro</label>
                                            <input class="form-check-input" style="margin-top: 1.4vh; background-color: #E99857; border-color: #E99857;" type="checkbox" v-model="etxekoa" :disabled="idCita != ''">
                                        </div>                        
                                    </div>
                                </div>
                            <input type="text" class="form-control" v-model="izena" :disabled="idCita != ''" style="background-color: white;">
                            </div>
                            <!-- Segunda Fila -->
                            <div class="col-md-12">
                                <div class="input-group" style="margin: 0;">
                                    <span class="input-group-text">Hora-Inicio</span>
                                    <input type="time" class="form-control" v-model="hasiera_ordua">
                                    <span class="input-group-text">Hora-Fin</span>
                                    <input type="time" class="form-control" v-model="amaiera_ordua">
                                    <span class="input-group-text">Fecha</span>
                                    <input type="date" class="form-control" :disabled="idCita != ''" style="background-color: white;" v-model="dataCita">
                                </div>
                            </div>
                            <!-- Tercera Fila -->
                            <div class="col-12">
                            <label for="inputAddress" class="form-label rounded bg-white p-2 mb-1">Telefonoa:</label>
                            <input type="text" class="form-control" v-model="telefonoa" :disabled="idCita != ''" style="background-color: white;">
                            </div>
                            <!-- Cuarta Fila -->
                            <div v-if="data <= hoy" class="col-md-4">
                                <label v-if="dataCita == hoy" class="form-label rounded bg-white p-2 mb-1">Grupo: {{grupoHoy}}</label>
                                <label v-else class="form-label rounded bg-white p-2 mb-1">Grupo: {{grupoCita}}</label>

                                <!-- <select class="form-select">
                                <option selected disabled value="">Grupo</option>
                                <option>...</option>
                                </select> -->
                            </div>
                            <div v-if="data <= hoy" class="col-md-8">
                                <!-- <label v-if="data == hoy" class="form-label rounded bg-white p-2 mb-1">Alumno</label> -->
                                <select v-if="dataCita == hoy" class="form-select">
                                <option selected disabled value="">Alumno</option>
                                <option>...</option>
                                </select>
                                <label v-else class="form-label rounded bg-white p-2 mb-1">Alumno: {{alumnoCita}}</label>
                            </div>
                            <!-- Quinta Fila -->
                            <div class="col-md-12">
                                <div class="row g-3" style="display: inline-flex;" v-if="idCita != ''">
                                    <div class="col">
                                        <label class="form-label rounded bg-white p-2 mb-1">Tratamiento: </label>
                                    </div>
                                    <div class="col">
                                        <select class="form-select" style="min-width: 15vw;" v-model="tratamendu">
                                            <option selected disabled value="">Tratamientos</option>
                                            <option v-for="tratamendus in tratamenduak" :value="tratamendus.id" :key="tratamendus.izena">{{tratamendus.izena}}</option>
                                        </select>      
                                    </div>
                                    <div class="col"  v-if="tratamendu == '0'" >
                                        <input class="form-control" type="number" v-model="extra"></div>
                                    <div class="col">
                                        <button class="btn" style="background-color: #E99857;" type="button" @click="tratamenduaGehitu">+</button>
                                        <button class="btn" style="background-color: #E99857;" type="button" @click="tratamenduaKendu">-</button>
                                    </div>
                                </div>
                            <textarea class="form-control" disabled style="background-color: white;" v-if="idCita != ''">{{tratamenduakCitaText}}</textarea>
                            </div>
                            <!-- Sexta Fila -->
                            <div class="col-12">
                                <label for="inputAddress" class="form-label rounded bg-white p-2 mb-1">Observaciones:</label>
                                <textarea class="form-control" v-model="deskribapena" :disabled="idCita != ''" style="background-color: white;"></textarea>
                            </div>
                            <!-- Fin -->
                            <div class="col-12">
                                <button v-if="idCita != ''"class="btn" type="button" style="background-color: #E99857;" @click="hitzorduaKendu">Eliminar</button>
                                <button v-else class="btn" type="button" style="background-color: #E99857;" @click="createCita" >Crear</button>
                                <button class="btn" type="button" style="background-color: #E99857;">Generar tiket</button>
                            </div>
                        </form>
                    </div>
                    <!--  -->
                    <br>
                    <input type="date" id="fecha" name="fecha" v-model="data">                    
                    <div class="table-responsive-xl">
                        <table class="table table-hover table-striped" v-if="bilatu != ''">
                            <thead>
                                <th scope="col">id</th>
                                <th scope="col">data</th>
                                <th scope="col">hasiera_ordua</th>
                                <th scope="col">amaiera_ordua</th>
                                <th scope="col">izena</th>
                                <th scope="col">telefonoa</th>
                                <th scope="col">deskribapena</th>
                                <th scope="col">etxekoa</th>
                                <th scope="col"></th>
                            </thead>
                            <tbody>
                                <tr v-for="(dato,index) in taula" @click="popupCita(dato.id)">
                                    <td scope="col">{{dato.id}}</td>
                                    <td scope="col">{{dato.data}}</td>
                                    <td scope="col">{{dato.hasiera_ordua}}</td>
                                    <td scope="col">{{dato.amaiera_ordua}}</td>
                                    <td scope="col">{{dato.izena}}</td>
                                    <td scope="col">{{dato.telefonoa}}</td>
                                    <td scope="col">{{dato.deskribapena}}</td>
                                    <td scope="col">{{dato.etxekoa}}</td>
                                    <td>
                                        <i class="bi bi-trash-fill"></i>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <table class="table" v-else>
                            <thead>
                                <tr>
                                    <th scope="col"></th>
                                    <th v-for="(dato,index) in taula[0]" scope="col" class="text-center">{{index+1}}</th>

                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(dato, index) in orduak">
                                    <th v-if="index % 4 === 0" :rowspan="4" scope="col">{{dato}}</th> <!-- cambiar 4 por 2 para que sea cada 30 mins -->                            
                                    <td @click="popupCita(taula[index][index2].id)" style="background-color: #E26B6B; border: 2px  solid black" v-for="(dato2, index2) in taula[index]" :rowspan="taula[index][index2].timeDif" scope="col" v-if="Object.keys(taula[index][index2]).length > 2">{{taula[index][index2].izena}}<br>{{taula[index][index2].orduak}}<br>{{taula[index][index2].deskribapena}}</td>
                                    <td scope="col" v-else-if="taula[index][index2].visible"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->            
            </div>
        </div>
        <script src="../JS/home.js"></script>
    </body>
</html>

<script src="../JS/header.js"></script>